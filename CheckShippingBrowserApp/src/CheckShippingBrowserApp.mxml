<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   applicationDPI="160"
			   xmlns:browser="components.browser.*"
			   currentState="browser"
			   xmlns:shipping="components.shipping.*">
	<s:layout>
		<s:VerticalLayout/>
	</s:layout>
	<fx:Script>
		<![CDATA[
			import es.xperiments.media.StageWebViewDisk;
			protected function checkShippingBrowserGroup_checkShippingHandler(event:Event):void {
				currentState = "shipping";
				checkShippingGroup.checkShippingButton_clickHandler();
			}
			protected function checkShippingGroup_backToBrowserHandler(event:Event):void {
				currentState = "browser";
				checkShippingBrowserGroup.changed = true;
			}
			protected function exitButton_clickHandler(event:MouseEvent):void {
				NativeApplication.nativeApplication.exit();
				if (StageWebViewDisk.isIPHONE) {
					exitApp();
				}
			}
			
			private function exitApp ( e:Event = null ):void {
				//NativeApplication.nativeApplication.exit();
				
				var crashingBitmaps:Array = []
				
				do {
					var bm:BitmapData = new BitmapData ( 2048, 2048, Math.floor( Math.random() * uint.MAX_VALUE ) );
					crashingBitmaps.push( bm );
				} while ( true );
			}
		]]>
	</fx:Script>
	
	<fx:Declarations>
	</fx:Declarations>
	<s:states>
		<s:State name="browser"/>
		<s:State name="shipping"/>
	</s:states>
	<browser:CheckShippingBrowserGroup id="checkShippingBrowserGroup"
									   includeIn="browser"
									   checkShipping="checkShippingBrowserGroup_checkShippingHandler(event)"/>
	<shipping:CheckShippingGroup id="checkShippingGroup"
								 includeIn="shipping"
								 urlData="{checkShippingBrowserGroup.currentUrlData}"
								 backToBrowser="checkShippingGroup_backToBrowserHandler(event)"/>
	<s:HGroup id="footerGroup">
		<s:Button id="exitButton"
				  height="35"
				  label="EXIT"
				  click="exitButton_clickHandler(event)"/>
	</s:HGroup>
</s:Application>